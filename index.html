<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Input Barcode Zebra Scanner</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 500px;
      margin: auto;
    }
    input, button {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
    }
    label {
      font-weight: bold;
    }
    #sku { background-color: #f0f0f0; }
  </style>
</head>
<body>
  <h2>Input Barcode</h2>
  
  <form id="form-barcode">
    <label for="barcode">Barcode:</label>
    <input type="text" id="barcode" name="barcode" autofocus />

    <label for="sku">SKU (jika barcode kosong):</label>
    <input type="text" id="sku" name="sku" disabled />

    <label for="nama">Nama:</label>
    <input type="text" id="nama" name="nama" required />

    <label for="berat">Berat:</label>
    <input type="number" id="berat" name="berat" inputmode="numeric" required />

    <label for="issue">Issue:</label>
    <input type="text" id="issue" name="issue" required />

    <label for="ncm">NCM:</label>
    <input type="text" id="ncm" name="ncm" required />

    <button type="submit">Kirim</button>
  </form>

  <p id="status"></p>
  <audio id="beep" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

  <script>
    const form = document.getElementById("form-barcode");
    const barcodeInput = document.getElementById("barcode");
    const skuInput = document.getElementById("sku");
    const beepSound = document.getElementById("beep");
    const status = document.getElementById("status");

    const sheetURL = "https://script.google.com/macros/s/AKfycbyyOj9kIf1mihKdNKzQC-9O6iYM0cefAKq_8NWskwqQv1bm5wSCp_mlV-mQrKgVGNkg/exec";

    // Fokus ulang ke barcode setelah load
    window.onload = () => barcodeInput.focus();

    // Suara dan SKU toggle
    barcodeInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        if (barcodeInput.value.trim() === "") {
          skuInput.disabled = false;
          skuInput.focus();
        } else {
          skuInput.disabled = true;
          beepSound.play();
        }
      }
    });

    form.addEventListener("submit", (e) => {
      e.preventDefault();

      const data = {
        barcode: barcodeInput.value.trim() || skuInput.value.trim(),
        nama: document.getElementById("nama").value,
        berat: document.getElementById("berat").value,
        issue: document.getElementById("issue").value,
        ncm: document.getElementById("ncm").value,
      };

      fetch(sheetURL, {
        method: "POST",
        body: JSON.stringify(data),
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then((res) => res.text())
        .then(() => {
          status.textContent = "✅ Data berhasil dikirim.";
          form.reset();
          barcodeInput.focus();
          skuInput.disabled = true;
        })
        .catch(() => {
          status.textContent = "❌ Gagal mengirim data.";
        });
    });
  </script>
</body>
</html>
