<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Input Barcode - Mode Zebra Scanner</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    label { font-weight: bold; display: block; margin-top: 10px; }
    input, select, button { width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 10px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h2>Input Barcode - Mode Zebra Scanner</h2>

  <label for="mode">Mode Input:</label>
  <select id="mode">
    <option value="single">Single</option>
    <option value="massal">Massal</option>
  </select>

  <div id="jumlah-bobbin-section" class="hidden">
    <label for="jumlahBobbin">Jumlah Bobbin:</label>
    <select id="jumlahBobbin"></select>
  </div>

  <div id="form-container"></div>

  <div id="single-input-section">
    <label for="tanggal">Tanggal:</label>
    <input type="date" id="tanggal">

    <label for="nama">Nama:</label>
    <input type="text" id="nama">

    <label for="issue">Issue:</label>
    <input type="text" id="issue">

    <label for="ncm">NCM:</label>
    <input type="text" id="ncm">
  </div>

  <button onclick="kirimData()">Kirim</button>

  <script>
    const modeSelect = document.getElementById('mode');
    const jumlahBobbinSelect = document.getElementById('jumlahBobbin');
    const jumlahBobbinSection = document.getElementById('jumlah-bobbin-section');
    const formContainer = document.getElementById('form-container');
    const singleInputSection = document.getElementById('single-input-section');

    for (let i = 1; i <= 10; i++) {
      const option = document.createElement('option');
      option.value = i;
      option.textContent = i;
      jumlahBobbinSelect.appendChild(option);
    }

    modeSelect.addEventListener('change', () => {
      if (modeSelect.value === 'massal') {
        jumlahBobbinSection.classList.remove('hidden');
        singleInputSection.classList.add('hidden');
        renderMassalForm(jumlahBobbinSelect.value);
      } else {
        jumlahBobbinSection.classList.add('hidden');
        singleInputSection.classList.remove('hidden');
        renderSingleForm();
      }
    });

    jumlahBobbinSelect.addEventListener('change', () => {
      if (modeSelect.value === 'massal') {
        renderMassalForm(jumlahBobbinSelect.value);
      }
    });

    function renderSingleForm() {
      formContainer.innerHTML = `
        <label for="barcode">Barcode:</label>
        <input type="text" id="barcode">

        <label for="berat">Berat:</label>
        <input type="number" id="berat" inputmode="decimal">
      `;
    }

    function renderMassalForm(jumlah) {
      let html = '';
      for (let i = 1; i <= jumlah; i++) {
        html += `
          <label for="tanggal${i}">Tanggal ${i}:</label>
          <input type="date" id="tanggal${i}">

          <label for="nama${i}">Nama ${i}:</label>
          <input type="text" id="nama${i}">

          <label for="issue${i}">Issue ${i}:</label>
          <input type="text" id="issue${i}">

          <label for="ncm${i}">NCM ${i}:</label>
          <input type="text" id="ncm${i}">

          <label for="barcode${i}">Barcode ${i}:</label>
          <input type="text" id="barcode${i}">

          <label for="berat${i}">Berat ${i}:</label>
          <input type="number" id="berat${i}" inputmode="decimal">
        `;
      }
      formContainer.innerHTML = html;
    }

    async function kirimData() {
      const mode = modeSelect.value;
      let data = [];

      if (mode === 'single') {
        data.push({
          tanggal: document.getElementById('tanggal').value,
          nama: document.getElementById('nama').value,
          issue: document.getElementById('issue').value,
          ncm: document.getElementById('ncm').value,
          barcode: document.getElementById('barcode').value,
          berat: document.getElementById('berat').value
        });
      } else {
        const jumlah = parseInt(jumlahBobbinSelect.value);
        for (let i = 1; i <= jumlah; i++) {
          data.push({
            tanggal: document.getElementById(`tanggal${i}`).value,
            nama: document.getElementById(`nama${i}`).value,
            issue: document.getElementById(`issue${i}`).value,
            ncm: document.getElementById(`ncm${i}`).value,
            barcode: document.getElementById(`barcode${i}`).value,
            berat: document.getElementById(`berat${i}`).value
          });
        }
      }

      try {
        await fetch("https://script.google.com/macros/s/AKfycbzsGLwFyAjQO3IKP4SUk5HVAPndXFWzbV6OAv4BjmRWfd1LmRD6D7aP-_HBS2Vm5ZDcyA/exec", {
          method: "POST",
          body: JSON.stringify(data),
          headers: { "Content-Type": "application/json" }
        });
        alert("✅ Data berhasil dikirim!");
      } catch (error) {
        alert("❌ Gagal mengirim data: " + error.message);
      }
    }

    renderSingleForm();
  </script>
</body>
</html>
